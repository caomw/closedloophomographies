function [x fval] = callObjConstr(x0, newHomo, detthresh, changethresh,...
    entry33thresh, smallsmallthresh, options)

if nargin < 8
    options = optimset('Algorithm', 'sqp', 'MaxFunEvals', 30000);
end

%[x fval] = fmincon(@objectiveh16istruth, x0, [], [], [], [], [], [], @nonlinearconst, options);
[x fval] = fmincon(@loop15, x0, [], [], [], [], [], [], @nonlinearconst15homogs, options);

    function f = objectiveh16istruth(xin)
    x12 = [xin(1), xin(2), xin(3); xin(4), xin(5), xin(6); xin(7), xin(8), 1];
    x23 = [xin(9), xin(10), xin(11); xin(12), xin(13), xin(14); xin(15), xin(16), 1];
    x34 = [xin(17), xin(18), xin(19); xin(20), xin(21), xin(22); xin(23), xin(24), 1];
    x45 = [xin(25), xin(26), xin(27); xin(28), xin(29), xin(30); xin(31), xin(32), 1];
    x56 = [xin(33), xin(34), xin(35); xin(36), xin(37), xin(38); xin(39), xin(40), 1];
    xcum = x12*x23*x34*x34*x45*x56;
    f = abs(xcum(1, 1) - newHomo(1, 1)) + abs(xcum(1, 2) - newHomo(1, 2)) + ...
        abs(xcum(1, 3) - newHomo(1, 3)) + abs(xcum(2, 1) - newHomo(2, 1)) + ...
        abs(xcum(2, 2) - newHomo(2, 2)) + abs(xcum(2, 3) - newHomo(2, 3)) + ...
        abs(xcum(3, 1) - newHomo(3, 1)) + abs(xcum(3, 2) - newHomo(3, 2)) + ...
        abs(xcum(3, 3) - newHomo(3, 3)); 
    end

    function f = loop15(xin)
    x0102 = [xin(1), xin(2), xin(3); xin(4), xin(5), xin(6); xin(7), xin(8), 1];
    x0203 = [xin(9), xin(10), xin(11); xin(12), xin(13), xin(14); xin(15), xin(16), 1];
    x0304 = [xin(17), xin(18), xin(19); xin(20), xin(21), xin(22); xin(23), xin(24), 1];
    x0405 = [xin(25), xin(26), xin(27); xin(28), xin(29), xin(30); xin(31), xin(32), 1];
    x0506 = [xin(33), xin(34), xin(35); xin(36), xin(37), xin(38); xin(39), xin(40), 1];
    x0607 = [xin(41), xin(42), xin(43); xin(44), xin(45), xin(46); xin(47), xin(48), 1];
    x0708 = [xin(49), xin(50), xin(51); xin(52), xin(53), xin(54); xin(55), xin(56), 1];
    x0809 = [xin(57), xin(58), xin(59); xin(60), xin(61), xin(62); xin(63), xin(64), 1];
    x0910 = [xin(65), xin(66), xin(67); xin(68), xin(69), xin(70); xin(71), xin(72), 1];
    x1011 = [xin(73), xin(74), xin(75); xin(76), xin(77), xin(78); xin(79), xin(80), 1];
    x1112 = [xin(81), xin(82), xin(83); xin(84), xin(85), xin(86); xin(87), xin(88), 1];
    x1213 = [xin(89), xin(90), xin(91); xin(92), xin(93), xin(94); xin(95), xin(96), 1];
    x1314 = [xin(97), xin(98), xin(99); xin(100), xin(101), xin(102); xin(103), xin(104), 1];
    x1415 = [xin(105), xin(106), xin(107); xin(108), xin(109), xin(110); xin(111), xin(112), 1];
    x1516 = [xin(113), xin(114), xin(115); xin(116), xin(117), xin(118); xin(119), xin(120), 1];
    xcum = x0102*x0203*x0304*x0405*x0506*x0607*x0708*x0809*x0910*x1011*x1112*x1213*x1314*x1415*x1516;
    f = abs(xcum(1, 1) - newHomo(1, 1)) + abs(xcum(1, 2) - newHomo(1, 2)) + ...
        abs(xcum(1, 3) - newHomo(1, 3)) + abs(xcum(2, 1) - newHomo(2, 1)) + ...
        abs(xcum(2, 2) - newHomo(2, 2)) + abs(xcum(2, 3) - newHomo(2, 3)) + ...
        abs(xcum(3, 1) - newHomo(3, 1)) + abs(xcum(3, 2) - newHomo(3, 2)) + ...
        abs(xcum(3, 3) - newHomo(3, 3)); 
    end

    function [c, ceq] = nonlinearconst5homogs(x)
    %detthresh = 0.10;
    %changethresh = 0.04;
    %entry33thresh = 0.01;
    %smallsmallthresh = 0.0002;
    x12 = [x(1), x(2), x(3); x(4), x(5), x(6); x(7), x(8), 1];
    x23 = [x(9), x(10), x(11); x(12), x(13), x(14); x(15), x(16), 1];
    x34 = [x(17), x(18), x(19); x(20), x(21), x(22); x(23), x(24), 1];
    x45 = [x(25), x(26), x(27); x(28), x(29), x(30); x(31), x(32), 1];
    x56 = [x(33), x(34), x(35); x(36), x(37), x(38); x(39), x(40), 1];
    x13 = x12*x23;
    x14 = x13*x34;
    x15 = x14*x45;
    x16 = x15*x56;
    ceq = [];
    c(1) = abs(det(x12) - 1) - detthresh;
    c(2) = abs(det(x23) - 1) - detthresh;
    c(3) = abs(det(x34) - 1) - detthresh;
    c(4) = abs(det(x45) - 1) - detthresh;
    c(5) = abs(det(x56) - 1) - detthresh;
    c(6:7) = abs(x(1:2) - x0(1:2)) - changethresh;
    c(8:9) = abs(x(4:5) - x0(4:5)) - changethresh;
    c(10:11) = abs(x(9:10) - x0(9:10)) - changethresh;
    c(12:13) = abs(x(12:13) - x0(12:13)) - changethresh;
    c(14:15) = abs(x(17:18) - x0(17:18)) - changethresh;
    c(16:17) = abs(x(20:21) - x0(20:21)) - changethresh;
    c(18:19) = abs(x(25:26) - x0(25:26)) - changethresh;
    c(20:21) = abs(x(28:29) - x0(28:29)) - changethresh;
    c(22:23) = abs(x(33:34) - x0(33:34)) - changethresh;
    c(24:25) = abs(x(36:37) - x0(36:37)) - changethresh;
    c(26) = abs(x13(3, 3) - 1) - entry33thresh;
    c(27) = abs(x14(3, 3) - 1) - entry33thresh;
    c(28) = abs(x15(3, 3) - 1) - entry33thresh;
    c(29) = abs(x16(3, 3) - 1) - entry33thresh;
    c(30:31) = abs(x(7:8) - x0(7:8)) - smallsmallthresh;
    c(32:33) = abs(x(15:16) - x0(15:16)) - smallsmallthresh;
    c(34:35) = abs(x(23:24) - x0(23:24)) - smallsmallthresh;
    c(36:37) = abs(x(31:32) - x0(31:32)) - smallsmallthresh;
    c(38:39) = abs(x(39:40) - x0(39:40)) - smallsmallthresh;
    c(40) = abs(x12(3, 3) - 1) - entry33thresh;
    end

    function [c, ceq] = nonlinearconst15matrix(x)
         ceq = [];
x0102 = [xin(8), xin(9), xin(10); xin(11), xin(12), xin(13); xin(14), xin(15), xin(16), 1];
x0203 = [xin(16), xin(17), xin(18); xin(19), xin(20), xin(21); xin(22), xin(23), xin(24), 1];
x0304 = [xin(24), xin(25), xin(26); xin(27), xin(28), xin(29); xin(30), xin(31), xin(32), 1];
x0405 = [xin(32), xin(33), xin(34); xin(35), xin(36), xin(37); xin(38), xin(39), xin(40), 1];
x0506 = [xin(40), xin(41), xin(42); xin(43), xin(44), xin(45); xin(46), xin(47), xin(48), 1];
x0607 = [xin(48), xin(49), xin(50); xin(51), xin(52), xin(53); xin(54), xin(55), xin(56), 1];
x0708 = [xin(56), xin(57), xin(58); xin(59), xin(60), xin(61); xin(62), xin(63), xin(64), 1];
x0809 = [xin(64), xin(65), xin(66); xin(67), xin(68), xin(69); xin(70), xin(71), xin(72), 1];
x0910 = [xin(72), xin(73), xin(74); xin(75), xin(76), xin(77); xin(78), xin(79), xin(80), 1];
x1011 = [xin(80), xin(81), xin(82); xin(83), xin(84), xin(85); xin(86), xin(87), xin(88), 1];
x1112 = [xin(88), xin(89), xin(90); xin(91), xin(92), xin(93); xin(94), xin(95), xin(96), 1];
x1213 = [xin(96), xin(97), xin(98); xin(99), xin(100), xin(101); xin(102), xin(103), xin(104), 1];
x1314 = [xin(104), xin(105), xin(106); xin(107), xin(108), xin(109); xin(110), xin(111), xin(112), 1];
x1415 = [xin(112), xin(113), xin(114); xin(115), xin(116), xin(117); xin(118), xin(119), xin(120), 1];
x1516 = [xin(120), xin(121), xin(122); xin(123), xin(124), xin(125); xin(126), xin(127), xin(128), 1];
x0103 = x12*x23;
x0104 = x13*x34;
x0105 = x14*x45;
x0106 = x15*x56;
x0107 = x16*x67;
x0108 = x17*x78;
x0109 = x18*x89;
x0110 = x19*x910;
x0111 = x110*x1011;
x0112 = x111*x1112;
x0113 = x112*x1213;
x0114 = x113*x1314;
x0115 = x114*x1415;
x0116 = x115*x1516;
c(1) = abs(det(x0102) - 1) - detthresh;
c(2) = abs(det(x0203) - 1) - detthresh;
c(3) = abs(det(x0304) - 1) - detthresh;
c(4) = abs(det(x0405) - 1) - detthresh;
c(5) = abs(det(x0506) - 1) - detthresh;
c(6) = abs(det(x0607) - 1) - detthresh;
c(7) = abs(det(x0708) - 1) - detthresh;
c(8) = abs(det(x0809) - 1) - detthresh;
c(9) = abs(det(x0910) - 1) - detthresh;
c(10) = abs(det(x1011) - 1) - detthresh;
c(11) = abs(det(x1112) - 1) - detthresh;
c(12) = abs(det(x1213) - 1) - detthresh;
c(13) = abs(det(x1314) - 1) - detthresh;
c(14) = abs(det(x1415) - 1) - detthresh;
c(15) = abs(det(x1516) - 1) - detthresh;
c(16) = abs(x0102(3, 3) - 1) - entry33thresh;
c(17) = abs(x0103(3, 3) - 1) - entry33thresh;
c(18) = abs(x0104(3, 3) - 1) - entry33thresh;
c(19) = abs(x0105(3, 3) - 1) - entry33thresh;
c(20) = abs(x0106(3, 3) - 1) - entry33thresh;
c(21) = abs(x0107(3, 3) - 1) - entry33thresh;
c(22) = abs(x0108(3, 3) - 1) - entry33thresh;
c(23) = abs(x0109(3, 3) - 1) - entry33thresh;
c(24) = abs(x0110(3, 3) - 1) - entry33thresh;
c(25) = abs(x0111(3, 3) - 1) - entry33thresh;
c(26) = abs(x0112(3, 3) - 1) - entry33thresh;
c(27) = abs(x0113(3, 3) - 1) - entry33thresh;
c(28) = abs(x0114(3, 3) - 1) - entry33thresh;
c(29) = abs(x0115(3, 3) - 1) - entry33thresh;
c(30) = abs(x0116(3, 3) - 1) - entry33thresh;
c(31:32) = abs(x(1:2) - x0(1:2)) - changethresh;
c(33:34) = abs(x(4:5) - x0(4:5)) - changethresh;
c(35:36) = abs(x(7:8) - x0(7:8)) - smallsmallthresh;
c(37:38) = abs(x(9:10) - x0(9:10)) - changethresh;
c(39:40) = abs(x(12:13) - x0(12:13)) - changethresh;
c(41:42) = abs(x(15:16) - x0(15:16)) - smallsmallthresh;
c(43:44) = abs(x(17:18) - x0(17:18)) - changethresh;
c(45:46) = abs(x(20:21) - x0(20:21)) - changethresh;
c(47:48) = abs(x(23:24) - x0(23:24)) - smallsmallthresh;
c(49:50) = abs(x(25:26) - x0(25:26)) - changethresh;
c(51:52) = abs(x(28:29) - x0(28:29)) - changethresh;
c(53:54) = abs(x(31:32) - x0(31:32)) - smallsmallthresh;
c(55:56) = abs(x(33:34) - x0(33:34)) - changethresh;
c(57:58) = abs(x(36:37) - x0(36:37)) - changethresh;
c(59:60) = abs(x(39:40) - x0(39:40)) - smallsmallthresh;
c(61:62) = abs(x(41:42) - x0(41:42)) - changethresh;
c(63:64) = abs(x(44:45) - x0(44:45)) - changethresh;
c(65:66) = abs(x(47:48) - x0(47:48)) - smallsmallthresh;
c(67:68) = abs(x(49:50) - x0(49:50)) - changethresh;
c(69:70) = abs(x(52:53) - x0(52:53)) - changethresh;
c(71:72) = abs(x(55:56) - x0(55:56)) - smallsmallthresh;
c(73:74) = abs(x(57:58) - x0(57:58)) - changethresh;
c(75:76) = abs(x(60:61) - x0(60:61)) - changethresh;
c(77:78) = abs(x(63:64) - x0(63:64)) - smallsmallthresh;
c(79:80) = abs(x(65:66) - x0(65:66)) - changethresh;
c(81:82) = abs(x(68:69) - x0(68:69)) - changethresh;
c(83:84) = abs(x(71:72) - x0(71:72)) - smallsmallthresh;
c(85:86) = abs(x(73:74) - x0(73:74)) - changethresh;
c(87:88) = abs(x(76:77) - x0(76:77)) - changethresh;
c(89:90) = abs(x(79:80) - x0(79:80)) - smallsmallthresh;
c(91:92) = abs(x(81:82) - x0(81:82)) - changethresh;
c(93:94) = abs(x(84:85) - x0(84:85)) - changethresh;
c(95:96) = abs(x(87:88) - x0(87:88)) - smallsmallthresh;
c(97:98) = abs(x(89:90) - x0(89:90)) - changethresh;
c(99:100) = abs(x(92:93) - x0(92:93)) - changethresh;
c(101:102) = abs(x(95:96) - x0(95:96)) - smallsmallthresh;
c(103:104) = abs(x(97:98) - x0(97:98)) - changethresh;
c(105:106) = abs(x(100:101) - x0(100:101)) - changethresh;
c(107:108) = abs(x(103:104) - x0(103:104)) - smallsmallthresh;
c(109:110) = abs(x(105:106) - x0(105:106)) - changethresh;
c(111:112) = abs(x(108:109) - x0(108:109)) - changethresh;
c(113:114) = abs(x(111:112) - x0(111:112)) - smallsmallthresh;
c(115:116) = abs(x(113:114) - x0(113:114)) - changethresh;
c(117:118) = abs(x(116:117) - x0(116:117)) - changethresh;
c(119:120) = abs(x(119:120) - x0(119:120)) - smallsmallthresh;
c(121:122) = abs(x(121:122) - x0(121:122)) - changethresh;
c(123:124) = abs(x(124:125) - x0(124:125)) - changethresh;
c(125:126) = abs(x(127:128) - x0(127:128)) - smallsmallthresh;
    end
end